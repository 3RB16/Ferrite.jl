facts("spring testing") do
    @fact spring1e(3.0) --> [3.0 -3.0; -3.0 3.0]
    @fact spring1s(3.0, [3.0, 1.0]) --> 3.0 * (1.0 - 3.0)
end


facts("plani4e testing") do

    K, f = plani4e([0, 1, 1.5, 0.5], [0.0, 0.2, 0.8, 0.6], [2, 2, 2], hooke(2, 210e9, 0.3), [1.0, 2.5])

    K_calfem =
  1e11*[1.367692307692308   0.067307692307692  -1.012307692307693   0.740384615384616   0.059230769230770  -0.740384615384616  -0.414615384615385  -0.067307692307692;
   0.067307692307692   2.121538461538462   0.336538461538462   0.576153846153845  -0.740384615384616   0.449615384615385   0.336538461538462  -3.147307692307693;
  -1.012307692307693   0.336538461538462   4.340000000000000  -2.759615384615385  -0.414615384615385   0.336538461538462  -2.913076923076923   2.086538461538462;
   0.740384615384616   0.576153846153845  -2.759615384615385   8.163076923076922  -0.067307692307692  -3.147307692307692   2.086538461538461  -5.591923076923075;
   0.059230769230770  -0.740384615384616  -0.414615384615385  -0.067307692307692   1.367692307692308   0.067307692307692  -1.012307692307693   0.740384615384616;
  -0.740384615384616   0.449615384615385   0.336538461538462  -3.147307692307692   0.067307692307692   2.121538461538462   0.336538461538462   0.576153846153845;
  -0.414615384615385   0.336538461538462  -2.913076923076923   2.086538461538461  -1.012307692307693   0.336538461538462   4.340000000000000  -2.759615384615385;
  -0.067307692307692  -3.147307692307693   2.086538461538462  -5.591923076923075   0.740384615384616   0.576153846153845  -2.759615384615385   8.163076923076924]

   f_calfem =
  [0.250;
   0.625;
   0.250;
   0.625;
   0.250;
   0.625;
   0.250;
   0.625]

    @fact norm(K - K_calfem) / norm(K) --> roughly(0.0, atol=1e-15)
    @fact norm(f - f_calfem) / norm(f) --> roughly(0.0, atol=1e-15)

end

